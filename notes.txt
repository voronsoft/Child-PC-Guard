----------------------------------------
- Компилируем приложения
pyinstaller app_admin.spec             Основное приложение
pyinstaller app_lock_unlock_usr.spec   Снятие блокировки с пользователя
pyinstaller app_monitor.spec           Мониторинг работы "Основного приложения"
pyinstaller app_timer.spec             Таймер времени до начала блокировки
pyinstaller uninstall.spec             Деинсталлятор всех приложений
pyinstaller app_monitor_mode_wnd.spec  Показывает статус работы службы (можно управлять работой службы).
pyinstaller app_service_windows.spec   Файл службы мониторинга, регистрирует службу в системе Windows.

----------------------------------------

----------------------------------------

Обновление файла с зависимостями:
--> pip freeze > requirements.txt
Установка модулей из файла с зависимостями
--> pip install -r requirements.txt
----------------------------------------


Создание и установка службы для windows если код на питоне
Шаг 1: Упаковка Python скрипта в exe с помощью PyInstaller
pip install pyinstaller

Соберите скрипт:
pyinstaller --onefile --name "ИмяСлужбы" --hidden-import=win32timezone myservice.py
--onefile: Собирает всё в один exe-файл.
--name: Указывает имя exe-файла.
--hidden-import=win32timezone: Для правильной работы с временем в службах Windows.
myservice.py: Ваш Python-скрипт.

После этого в папке dist появится собранный exe-файл.

Шаг 2: Установка exe-файла как службы
После того, как вы собрали Python-скрипт в exe-файл, можно установить его как службу с помощью команды sc create.
sc create "ИмяСлужбы" binPath= "C:\Путь\к\собранному\файлу.exe"
"ИмяСлужбы": Имя вашей службы.
binPath=: Полный путь к собранному exe-файлу.

Шаг 3: Альтернативный способ (использование pywin32)

1 Можно использовать библиотеку pywin32 для написания Windows службы напрямую на Python.
Вот как установить Python-службу: Установите pywin32: pip install pywin32

2 Напишите Python-код для службы с использованием pywin32 и сохраните его.

3 Для установки такой службы с помощью pywin32, используйте python.exe и вызовите скрипт напрямую, например:
python myservice.py install

Этот подход не требует предварительной компиляции Python-скрипта в exe, но служба должна будет запускаться через интерпретатор Python.
Который должен быть установлен на ПК
Важным моментом должно быть правильно настроено окружение питона и зависимости,
так как по некоторым причинам при запуске такой службы как файл питона
есь вероятность выдачи ошибки, что служба не запустилась или не ответила в своевременно.
Для этого нужно правильно переустановить модуль - pywin32
В документации на сайте это описано подробней.
Некоторые файлы нужно перенести ручками в нужные папки.
Если этого не сделать будут ошибки запуска службы.

Команды для CMD администратор
Установка службы (если это .exe файл): sc create "ИмяСлужбы" binPath= "C:\Путь\к\программе.exe"
Установка службы (если это .py файл): python your_script.py install

1 - Просмотр состояния службы (работает\не работает): sc query "ИмяСлужбы"
2 - Удаление службы: sc delete "ИмяСлужбы"
3 - Запуск службы: sc start "ИмяСлужбы" или sc config "AppTestService" start= auto
Пояснение для запуска службы в автоматическом режиме - запущено:
Если хотите, чтобы служба сразу стартовала после установки, добавьте команду для её запуска:
python your_service.py install (Первая команда устанавливает службу. Используется вариант python скрипта с помощью библиотеки win32)
sc config "AppTestService" start= auto (Вторая команда задает режим запуска службы на "автоматически" (start= auto) после каждой перезагрузки ПК)
net start "AppTestService" (Если хотите, чтобы служба сразу стартовала после установки, добавьте команду для её запуска)

4 - Остановка службы: sc stop "ИмяСлужбы"






















